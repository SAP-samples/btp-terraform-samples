'use strict';

const sapStatisticsUtils = require('../utils/sap-statistics-utils');

module.exports = function(req, res, next) {

  if (sapStatisticsUtils.isSapStatisticsEnabled(req) === false) {
    return next();
  }

  sapStatisticsUtils.setTime(sapStatisticsUtils.START_TOTAL, req);

  if (sapStatisticsUtils.isSapStatisticsEnabledByQueryParameter(req) && (!sapStatisticsUtils.isSapStatisticsEnabledByRequestHeader(req)))
  {
    req.headers['sap-statistics'] = true;
  }

  next();
};