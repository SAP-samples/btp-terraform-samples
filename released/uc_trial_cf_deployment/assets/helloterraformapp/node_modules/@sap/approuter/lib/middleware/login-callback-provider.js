'use strict';

module.exports = {
  isLoginCallback: function (req) {
    return (req.url.includes(req.routerConfig.appConfig.login.callbackEndpoint) && req.method === 'GET' && !(isSessionExists(req)));
  }
};

function isSessionExists(req) {
  return req.session && req.session.user && req.session.user.token && req.session.user.token.expiryDate > Date.now();
}
