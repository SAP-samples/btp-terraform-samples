'use strict';

const logoutProvider = require('./logout-provider');

module.exports = function (req, res, next) {
  if (logoutProvider.isLogoutRequest(req)) {
    let err = logoutProvider.isReqMethodMatchesLogoutMethod(req);
    if (err) {
      return next(new Error(err));
    }
    return logoutProvider.centralLogout(req, res);
  }
  next();
};